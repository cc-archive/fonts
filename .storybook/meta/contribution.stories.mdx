import { Meta } from "@storybook/addon-docs/blocks";

<Meta title="Fonts/Contribution" />

# Contribution

We're always looking for contributors to help us find and fix bugs, build new
features, help us improve the project documentation or translate the project to
another language.

Fonts is continuously evolving and improving. You can contribute to the
project in a number of ways.

| What       | How                                                                                                                                                   |
| ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Code**   | If you are a developer, feel free to resolve open issues, proof PRs, add new features to existing components or add new components altogether.        |
| **Design** | If you are a designer, your inputs on making every component more intuitive, aesthetic and joyful will reverberate through the entire ecosystem.      |
| **Test**   | If you are a user of these components, your feedback, bug reports and feature requests will drive the project forward so that we can meet your needs. |
| **Write**  | If you have a knack for writing technical articles, you could be the voice of the library's documentation, making it easy to use and understand.      |
| **Share**  | If you can't contribute in these ways, you can refer the project to a friend who might be able to. Spreading the word is the easiest way to help out. |

Interested?

The following instructions are in addition to the processes in our general [Contribution][contribution] and
[Pull Request][pull_request] guidelines on the Creative Common Open Source website, and [those] in Vocabulary. If you
haven't read them already, read them first.

[contribution]: https://creativecommons.github.io/contributing-code/
[pull_request]: https://opensource.creativecommons.org/contributing-code/pr-guidelines/
[those]: https://cc-vocabulary.netlify.com/?path=/docs/vocabulary-contribution--page

These instructions are a port of the general guidelines, tailored specifically for Fonts.

## Setting up

Clone the repository. If you intend to contribute, which you should, fork the repo from GitHub's GUI and clone your fork
instead. See GitHub Help pages for [instructions on how to do that](https://help.github.com/en/github/getting-started-with-github/fork-a-repo).

To setup you can either use Docker and Docker Compose or manually set up the project. Both have their advantages and
disadvantages.

Docker makes sure every developer has a consistent and identical development setup. It also removes the entire hassle
involved in dependency management. On the other hand, it is heavy and hits system resources particularly hard.

Manual setups are lightweight, tweakable and much more performant as the code runs very close to the operating
system. On the other hand, all dependencies must be manually resolved and each developer has a different setup.

### Docker and Docker Compose

Install Docker and Docker Compose, if you don't already have them on your computer.

Bring up all services.

```bash
$ docker-compose up -d
```

To run `npm` commands, you'll need to enter a Fonts container.

```bash
$ ./docker/fonts/run.sh
docker-desktop:/codebase$ ...
```

If you install new packages, you'll need to rebuild a few things.

```bash
$ docker-compose down
$ docker volume prune
$ docker-compose build storybook
```

### Manual setup

Install Node.js and NPM, if you don't already have them on your computer.

Install dependencies.

```
$ npm install
```

Start the following processes in different terminals

- SCSS build process: watches SCSS files and rebuilds them if any of them change
- the Storybook process: interactive playground of components in the browser

```
$ npm run watch
$ npm run storybook
```

## Discussing changes, assigning work, making changes and testing

See [Vocabulary guidelines].

[vocabulary guidelines]: https://cc-vocabulary.netlify.com/?path=/docs/vocabulary-contribution--page

## Changing icons

### Setting up requirements

We use SVGs from the Font Awesome icon set for our icons. Get a copy from their
[GitHub repository](https://github.com/FortAwesome/Font-Awesome) or from the
[Download page](https://fontawesome.com/how-to-use/on-the-web/setup/hosting-font-awesome-yourself).

To add, remove, or otherwise modify icons, you need to use [IcoMoon](https://icomoon.io/). IcoMoon is a custom
icon-font builder, which allows selecting icons and converting them to fonts. IcoMoon can be used without an account,
but it's recommended to have one.

### Working in IcoMoon

Open the [IcoMoon app](https://icomoon.io/app/).

<img
  src="guide/app_button.png"
  className="guide-image"
  style={{ maxHeight: "814px" }}
/>

If this is your first time, the Vocabulary project will not be loaded and, instead, one named 'Untitled Project' will.
Spot this icon in the top right corner.

<img
  src="guide/untitled_project.png"
  className="guide-image"
  style={{ maxHeight: "814px" }}
/>

Click on the name 'Untitled Project' to go to the Projects page. A page like this should show up.

<img
  src="guide/projects_untitled.png"
  className="guide-image"
  style={{ maxHeight: "814px" }}
/>

Remove the project 'Untitled Project' by clicking the `Remove` button to the right of the project name. An
'Import Project' button like the following should appear. Click on it.

<img src="guide/import_project.png" style={{ maxHeight: "18.5px" }} />

Navigate to `src/fonts/` and select the file `VocabularyIcons.json` which contains JSON data for all the icons in the
font. Import it to add the 'Vocabulary Icons' project. 'Vocabulary Icons' should now be imported as a project.

<img
  src="guide/projects_vocabulary.png"
  className="guide-image"
  style={{ maxHeight: "814px" }}
/>

Click the 'Load' button to the right of the project name to start making modifications. This takes us to the Selection
page.

<img
  src="guide/selection.png"
  className="guide-image"
  style={{ maxHeight: "814px" }}
/>

Each group on the page has a corresponding code point range.

| Shape set    | Code point        |
| ------------ | ----------------- |
| Pointers     | `\e9**`           |
| Symbols      | `\ea**` & `\eb**` |
| CC           | `\ec**`           |
| Social media | `\ed**`           |

You can select/deselect, delete, move and edit icons using the respective tools in toolbar. Deselected icons will not be
a part of the icon font, but will still be a part of the project. Removed icons will be removed from the project
altogether.

<img src="guide/toolbar.png" style={{ maxHeight: "32px" }} />

To add icons to a new set, use the 'Import Icons' button. To add icons to an existing set, use the 'Import to Set' menu
option in the context menu of that particular set.

<img src="guide/import_icons.png" style={{ maxHeight: '32px', verticalAlign: 'middle' }} />
&emsp;/&emsp;
<img src="guide/import_to_set.png" className="guide-image" style={{ maxHeight: '107px', verticalAlign: 'middle' }} />

Navigate to the directory containing the SVGs. In the case of FontAwesome it is `svgs/solid/`.

<img src="guide/directory.png" style={{ maxHeight: "446.5px" }} />

With the icon added, use the move tool to move it to it's right position and select tool to activate it.

<img src="guide/flag.png" style={{ maxHeight: "72px" }} />

Proceed to the Generate Font section by clicking the navigation button on the bottom of the page. Locate your icon on
the page. Add the correct code point and ligature for the icon. Ideally, use the next code point of the shape set and
the same ligature as the icon name.

<img
  src="guide/generate_font.png"
  className="guide-image"
  style={{ maxHeight: "814px" }}
/>

Click on the 'Download' button to get the font.

Now, click on the menu icon present in the top-left corner of the same page, and select `Manage Projects` to go the `Projects` page.

<img
  src="guide/projects.jpg"
  className="guide-image"
  style={{ maxHeight: "814px" }}
/>

Thereafter, click on the `Download` option to get the JSON data dump of the project, rename the file to `VocabularyIcons.json` and
add it to the `src/fonts/` directory.

<img
  src="guide/generate_json.png"
  className="guide-image"
  style={{ maxHeight: "814px" }}
/>

### Updating code

Find the TTF and WOFF files inside the downloaded zip and move them into the directory `src/fonts/`, replacing the ones
already present there. The file names may be different but you can rename them to match the existing ones.

Also, find a `selection.json` file in the root of the extracted zip. Open the file,
find the new icons (the icons you just added), and add them to the `icons` array & `selection` array in the `VocabularyIcons.json` file, present in `src/fonts/` directory.

```json
"icons": [
  ...
  {
    "id": 0,
    "paths": [
      "M512 1008c273.934 0 496-222.066 496-496s-222.066-496-496-496c-273.933 0-496 222.067-496 496s222.067 496 496 496zM389.319 216.191c31.747-1.449 41.882-1.791 122.717-1.791 80.831 0 90.966 0.343 122.714 1.791 31.681 1.445 53.317 6.477 72.247 13.835 19.572 7.605 36.172 17.782 52.718 34.329s26.724 33.146 34.33 52.718c7.357 18.932 12.39 40.569 13.835 72.246 1.448 31.747 1.789 41.882 1.789 122.717 0 80.831-0.341 90.966-1.789 122.714-1.445 31.681-6.478 53.317-13.835 72.247-7.605 19.572-17.783 36.172-34.33 52.718s-33.146 26.724-52.718 34.33c-18.931 7.357-40.566 12.39-72.247 13.835-31.747 1.448-41.882 1.789-122.714 1.789-80.835 0-90.97-0.341-122.717-1.789-31.678-1.445-53.315-6.478-72.246-13.835-19.572-7.605-36.171-17.783-52.718-34.33s-26.723-33.146-34.329-52.718c-7.358-18.931-12.39-40.566-13.835-72.247-1.449-31.747-1.791-41.882-1.791-122.714 0-80.835 0.343-90.97 1.791-122.717 1.445-31.678 6.477-53.315 13.835-72.246 7.605-19.572 17.782-36.171 34.329-52.718s33.146-26.723 52.718-34.329c18.932-7.358 40.569-12.39 72.246-13.835zM632.306 269.764c-31.387-1.432-40.798-1.736-120.27-1.736s-88.887 0.304-120.27 1.736c-29.019 1.323-44.779 6.172-55.268 10.248-13.893 5.399-23.808 11.849-34.222 22.265-10.416 10.415-16.866 20.329-22.265 34.222-4.076 10.489-8.925 26.248-10.248 55.268-1.432 31.384-1.736 40.798-1.736 120.27s0.304 88.887 1.736 120.27c1.323 29.019 6.172 44.779 10.248 55.264 5.399 13.895 11.85 23.808 22.265 34.224s20.329 16.864 34.222 22.264c10.489 4.077 26.248 8.925 55.268 10.247 31.38 1.432 40.791 1.736 120.27 1.736 79.476 0 88.89-0.304 120.27-1.736 29.019-1.323 44.779-6.17 55.264-10.247 13.895-5.4 23.808-11.848 34.224-22.264s16.864-20.329 22.264-34.224c4.077-10.485 8.925-26.245 10.247-55.264 1.432-31.384 1.736-40.798 1.736-120.27s-0.304-88.887-1.736-120.27c-1.323-29.019-6.17-44.779-10.247-55.268-5.4-13.893-11.848-23.808-22.264-34.222-10.416-10.416-20.329-16.866-34.224-22.265-10.485-4.076-26.245-8.925-55.264-10.248zM412.846 512.036c0 54.795 44.418 99.213 99.213 99.213 54.791 0 99.21-44.418 99.21-99.213 0-54.791-44.418-99.21-99.21-99.21-54.795 0-99.213 44.418-99.213 99.21zM359.219 512.036c0-84.409 68.428-152.837 152.841-152.837 84.409 0 152.837 68.428 152.837 152.837 0 84.413-68.428 152.841-152.837 152.841-84.413 0-152.841-68.428-152.841-152.841zM706.63 353.144c0 19.721-15.984 35.705-35.705 35.705-19.718 0-35.702-15.984-35.702-35.705 0-19.719 15.984-35.705 35.702-35.705 19.721 0 35.705 15.986 35.705 35.705z"
    ],
    "attrs": [
      {}
    ],
    "isMulticolor": false,
    "isMulticolor2": false,
    "grid": 0,
    "tags": [
      "instagram"
    ],
    "defaultCode": 60672
  },
  ...
]
```

```json
"selection": [
  ...
    {
      "order": 33,
      "id": 0,
      "name": "instagram",
      "prevSize": 32,
      "tempChar": "юди",
      "ligatures": "instagram",
      "code": 60672
    },
  ...
```

Add the icon to the SCSS variable `$icons`.

```scss
$icons: (... "flag": "\ea0b", ...);
```

Update the story 'Vocabulary Icons' to add the icons to the list.

```html
<IconGallery>
  ...
  <IconItem name="flag">
    <i class="icon flag"></i>
  </IconItem>
</IconGallery>
```
